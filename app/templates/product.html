{% extends "base.html" %}
{% block content %}
<div class="product-container">
    <div class="figma-glass">
        <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Ç–æ–≤–∞—Ä–∞ —Å –∫–Ω–æ–ø–∫–æ–π –Ω–∞–∑–∞–¥ -->
        <div class="product-header">
            <div class="header-top">
                <a href="javascript:history.back()" class="back-btn">
                    <i class="fa fa-arrow-left" aria-hidden="true"></i>
                    <span class="back-text">–ù–∞–∑–∞–¥</span>
                </a>
                <div class="category-badge">{{ product.category_product }}</div>
            </div>
            <h1 class="product-title">{{ product.title_product }}</h1>
        </div>

        <div class="product-content">
            <!-- –õ–µ–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞ - –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ -->
            <div class="product-image-section">
                <div class="product-image">
                    <img class="product-image-product" src="../../static/{{product.img_path_product}}" alt="{{ product.title_product }}">
                </div>
            </div>

            <!-- –ü—Ä–∞–≤–∞—è –∫–æ–ª–æ–Ω–∫–∞ - –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –∏ –ø–æ–∫—É–ø–∫–∞ -->
            <div class="product-info-section">
                <!-- –¶–µ–Ω–∞ –∏ –Ω–∞–ª–∏—á–∏–µ -->
                <div class="price-section">
                <div class="current-price">{{ "%.2f"|format(product.price_product) }} ‚ÇΩ</div>
                </div>

                <!-- –í—ã–±–æ—Ä —Ü–≤–µ—Ç–∞ RAL -->
                <div class="ral-selection">
                    <label class="ral-label">
                        –¶–≤–µ—Ç RAL (–º–æ–∂–µ—Ç –æ—Ç–ª–∏—á–∞—Ç—å—Å—è):
                    </label>
                    
                    <!-- –ö–∞—Å—Ç–æ–º–Ω—ã–π —Å–µ–ª–µ–∫—Ç -->
                    <div class="custom-select">
                        <div class="select-header" id="selectHeader">
                            <span class="select-placeholder">–í—ã–±–µ—Ä–∏—Ç–µ —Ü–≤–µ—Ç RAL</span>
                            <span class="select-arrow">‚åÑ</span>
                        </div>
                        <div class="select-options" id="selectOptions">
                            <div class="search-box">
                                <input type="text" id="ralSearch" placeholder="–ü–æ–∏—Å–∫ –ø–æ RAL –∏–ª–∏ –Ω–∞–∑–≤–∞–Ω–∏—é..." class="search-input">
                                <span class="search-icon">üîç</span>
                            </div>
                            <div class="options-list" id="optionsList">
                                <!-- –û–ø—Ü–∏–∏ –±—É–¥—É—Ç –∑–∞–ø–æ–ª–Ω–µ–Ω—ã —á–µ—Ä–µ–∑ JavaScript -->
                            </div>
                        </div>
                    </div>
                    
                    <input type="hidden" name="ral_color" id="ralSelect">
                    
                    <!-- –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä —Ü–≤–µ—Ç–∞ -->
                    <div id="ralColorPreview" class="ral-color-preview">
                        <div class="preview-content">
                            <div class="text-overlay">
                                <span class="ral-code">RAL</span>
                                <span class="color-name">–í—ã–±–µ—Ä–∏—Ç–µ —Ü–≤–µ—Ç</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- –§–æ—Ä–º–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –≤ –∫–æ—Ä–∑–∏–Ω—É -->
                <form method="post" action="{{ url_for('buyer.add_to_cart') }}" class="cart-form">
                    <input type="hidden" name="product_id" value="{{ product.id_product }}">
                    <input type="hidden" name="selected_ral" id="selectedRal" value="">
                    <div class="quantity-section">
                        <label class="quantity-label">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ:</label>
                        <div class="quantity-controls">
                            <button type="button" class="quantity-btn minus-btn">-</button>
                            <input name="qty" type="number" value="1" min="1" class="quantity-input">
                            <button type="button" class="quantity-btn plus-btn">+</button>
                        </div>
                    </div>

                    <div class="action-buttons">
                        <button type="submit" class="add-to-cart-btn">
                            <span class="btn-icon">üõí</span>
                            <span class="btn-text">–î–æ–±–∞–≤–∏—Ç—å –≤ –∫–æ—Ä–∑–∏–Ω—É</span>
                        </button>
                    </div>
                </form>
            </div>
        </div>

        <!-- –û–ø–∏—Å–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ -->
        <div class="product-description">
            <h3 class="description-title">–û–ø–∏—Å–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞</h3>
            <div class="description-content">
                <p class="description-text">{{ product.description_product }}</p>

                <div class="tech-specs">
                    <h4>–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:</h4>
                    <ul class="specs-list">
                        <li>–î–æ–ª–≥–æ–≤—Ä–µ–º–µ–Ω–Ω–∞—è –∑–∞—â–∏—Ç–∞ –æ—Ç –∫–æ—Ä—Ä–æ–∑–∏–∏ –Ω–∞ –≤—Å–µ—Ö —ç—Ç–∞–ø–∞—Ö –ø—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–∞</li>
                        <li>–£—Å—Ç–æ–π—á–∏–≤–æ—Å—Ç—å –∫ –Ω–∞–≥—Ä–µ–≤–∞–Ω–∏—é –¥–æ 800¬∞C —Å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–º –æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ–º —Å–æ–ª–µ–π —Ü–∏–Ω–∫–∞</li>
                        <li>–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å –≤—ã—Å–æ–∫–æ—Å–∫–æ—Ä–æ—Å—Ç–Ω–æ–π —Å–≤–∞—Ä–∫–æ–π –∏ —Ä–µ–∑–∫–æ–π</li>
                        <li>–ü—Ä–µ–≤–æ—Å—Ö–æ–¥–Ω–∞—è —Å—Ç–æ–π–∫–æ—Å—Ç—å –∫ –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–∏—è–º –æ—Ç —Å–≤–∞—Ä–æ—á–Ω—ã—Ö —Ä–∞–±–æ—Ç</li>
                        <li>–°–Ω–∏–∂–µ–Ω–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏–π –ø–æ –≤—Ç–æ—Ä–∏—á–Ω–æ–π –ø–æ–¥–≥–æ—Ç–æ–≤–∫–µ –ø–æ–≤–µ—Ä—Ö–Ω–æ—Å—Ç–∏</li>
                        <li>–ò–¥–µ–∞–ª—å–Ω–æ –¥–ª—è –º–µ—Ç–∞–ª–ª–æ–∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–π –∏ –ø—Ä–æ–º—ã—à–ª–µ–Ω–Ω–æ–≥–æ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è</li>
                    </ul>
                </div>

                <div class="application-areas">
                    <h4>–û–±–ª–∞—Å—Ç–∏ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è:</h4>
                    <div class="areas-grid">
                        <div class="area-item">–ú–µ—Ç–∞–ª–ª–æ–∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏</div>
                        <div class="area-item">–ü—Ä–æ–º—ã—à–ª–µ–Ω–Ω–æ–µ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ</div>
                        <div class="area-item">–ú–æ—Å—Ç—ã –∏ —Å–æ–æ—Ä—É–∂–µ–Ω–∏—è</div>
                        <div class="area-item">–°—É–¥–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ</div>
                        <div class="area-item">–ê–≤—Ç–æ–º–æ–±–∏–ª—å–Ω–∞—è –ø—Ä–æ–º—ã—à–ª–µ–Ω–Ω–æ—Å—Ç—å</div>
                        <div class="area-item">–°—Ç—Ä–æ–∏—Ç–µ–ª—å–Ω—ã–µ –∫–æ–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
.product-container {
    max-width: 1500px;
    margin: 0 auto;
    padding: 20px;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    min-height: 100vh;
}

.product-card {
    background: white;
    border-radius: 20px;
    box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
    overflow: hidden;
    padding: 40px;
    margin: 20px 0;
}


/* –°—Ç–∏–ª–∏ –¥–ª—è –∫–Ω–æ–ø–∫–∏ "–ù–∞–∑–∞–¥" */
.header-top {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 15px;
    flex-wrap: wrap;
    gap: 15px;
}

.back-btn {
    display: inline-flex;
    align-items: center;
    gap: 10px;
    padding: 12px 20px;
    background: var(--secondary-gradient);
    color: white;
    text-decoration: none;
    border-radius: 12px;
    font-weight: 600;
    transition: all 0.3s ease;
    border: 2px solid transparent;
    box-shadow: 0 4px 15px rgba(102, 126, 234, 0.3);
}

.back-btn:hover {
    transform: translateX(-5px);
    box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
    background: linear-gradient(135deg, #4852d8ff 0%, #4e46c1ff 100%);
}

.back-icon {
    font-size: 18px;
    font-weight: bold;
    transition: transform 0.3s ease;
}

.back-btn:hover .back-icon {
    transform: translateX(-3px);
}

.back-text {
    font-size: 14px;
}

.category-badge {
    display: inline-block;
    background: var(--secondary-gradient);
    color: white;
    padding: 8px 16px;
    border-radius: 20px;
    font-size: 14px;
    font-weight: 600;
}

.product-title {
    color: white;
    font-size: 36px;
    font-weight: 700;
    margin-bottom: 10px;
    line-height: 1.2;
}

.product-content {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 50px;
    margin-bottom: 40px;
}

.product-image-section {
    display: flex;
    flex-direction: column;
    gap: 20px;
}

.product-image {
    background: #f8fafc;
    border-radius: 16px;
    text-align: center;
    position: relative;
    overflow: hidden;
}

.price-section {
    display: flex;
    align-items: baseline;
    gap: 15px;
    margin-bottom: 20px;
    flex-wrap: wrap;
}

.current-price {
    font-size: 42px;
    font-weight: 700;
    color: #2d3748;
    background: var(--secondary-gradient);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
}

/* –°—Ç–∏–ª–∏ –¥–ª—è –≤—ã–±–æ—Ä–∞ RAL */
.ral-selection {
    margin-bottom: 25px;
    position: relative;
}

.ral-label {
    display: flex;
    align-items: center;
    gap: 8px;
    margin-bottom: 12px;
    color: white;
    font-weight: 600;
    font-size: 16px;
}

.label-icon {
    font-size: 18px;
}

/* –ö–∞—Å—Ç–æ–º–Ω—ã–π —Å–µ–ª–µ–∫—Ç */
.custom-select {
    position: relative;
    margin-bottom: 0;
    z-index: 20; /* –í—ã—Å–æ–∫–∏–π z-index —á—Ç–æ–±—ã –ø–µ—Ä–µ–∫—Ä—ã–≤–∞—Ç—å preview */
}

.select-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 15px 20px;
    border: 2px solid #e2e8f0;
    border-radius: 12px;
    background: #272727;
    cursor: pointer;
    transition: all 0.3s ease;
    min-height: 56px;
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
    position: relative;
    z-index: 25;
}

.select-header:hover {
    border-color: #667eea;
    transform: translateY(-1px);
    box-shadow: 0 4px 15px rgba(102, 126, 234, 0.1);
}

.select-header.active {
    border-color: #667eea;
    box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
}

.select-placeholder {
    color: #b8b8b8ff;
    font-size: 16px;
    font-weight: 500;
}

.select-arrow {
    color: #c2c2c2ff;
    font-size: 20px;
    transition: transform 0.3s ease;
}

.select-header.active .select-arrow {
    transform: rotate(180deg);
}

.select-options {
    position: absolute;
    top: calc(100% + 5px);
    left: 0;
    right: 0;
    background: #272727;
    border: 2px solid #e2e8f0;
    border-radius: 12px;
    box-shadow: 0 10px 30px rgba(0, 0, 0, 0.15);
    z-index: 30; /* –°–∞–º—ã–π –≤—ã—Å–æ–∫–∏–π z-index –¥–ª—è –≤—ã–ø–∞–¥–∞—é—â–µ–≥–æ —Å–ø–∏—Å–∫–∞ */
    display: none;
    max-height: 400px;
    overflow: hidden;
}

.select-options.show {
    display: block;
    animation: slideDown 0.3s ease;
}

@keyframes slideDown {
    from {
        opacity: 0;
        transform: translateY(-10px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.search-box {
    position: relative;
    padding: 15px;
    border-bottom: 1px solid #e2e8f0;
    background: #272727;
    color: white;
}

.search-input {
    width: 100%;
    padding: 12px 45px 12px 15px;
    border: 2px solid #e2e8f0;
    border-radius: 8px;
    font-size: 14px;
    transition: all 0.3s ease;
    background: #272727;
    color: white;
}

.search-input:focus {
    outline: none;
    border-color: #667eea;
    box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
}

.search-icon {
    position: absolute;
    right: 25px;
    top: 50%;
    transform: translateY(-50%);
    color: #718096;
    font-size: 16px;
}

.options-list {
    max-height: 300px;
    overflow-y: auto;
    padding: 10px 0;
}

.option-item {
    color: white;
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 12px 20px;
    cursor: pointer;
    transition: all 0.2s ease;
    border-left: 3px solid transparent;
}

.option-item:hover {
    background: #6b6b6bff;
    border-left-color: #667eea;
}

.option-item.selected {
    background: var(--secondary-gradient);
    border-left-color: #667eea;
}

.option-color {
    width: 24px;
    height: 24px;
    border-radius: 6px;
    border: 2px solid #e2e8f0;
    flex-shrink: 0;
    transition: all 0.3s ease;
    box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
}

.option-item:hover .option-color {
    transform: scale(1.1);
    box-shadow: 0 3px 8px rgba(0, 0, 0, 0.15);
}

.option-info {
    flex: 1;
    min-width: 0;
}

.option-ral {
    font-weight: 700;
    color: white;
    font-size: 14px;
    margin-bottom: 2px;
}

.option-name {
    color: white;
    font-size: 13px;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.no-results {
    padding: 20px;
    text-align: center;
    color: #718096;
    font-size: 14px;
}

/* –ü—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä —Ü–≤–µ—Ç–∞ */
.ral-color-preview {
    width: 100%;
    height: 80px;
    border: 2px solid #e2e8f0;
    border-radius: 0 0 12px 12px;
    transition: all 0.3s ease;
    position: relative;
    overflow: hidden;
    background: #272727;
    margin-top: -12px;
    padding-top: 20px;
    z-index: 10; /* –ù–∏–∑–∫–∏–π z-index —á—Ç–æ–±—ã —Å–µ–ª–µ–∫—Ç –ø–µ—Ä–µ–∫—Ä—ã–≤–∞–ª */
}

.ral-color-preview.has-color {
    border-color: #667eea;
    background: var(--selected-color, #f8fafc);
    border-top: none;
}


.preview-content {
    display: flex;
    align-items: center;
    justify-content: center;
    height: 100%;
    position: relative;
    z-index: 2;
}

.text-overlay {
    background-color: #27272780;
    padding: 12px 20px;
    border-radius: 8px;
    border: 1px solid rgba(0, 0, 0, 0.1);
    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
    text-align: center;
    backdrop-filter: blur(10px);
}

.ral-code {
    display: block;
    font-size: 18px;
    font-weight: 700;
    color: white;
    margin-bottom: 4px;
}

.color-name {
    display: block;
    font-size: 14px;
    color: white;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    max-width: 200px;
}


.ral-color-preview:not(.has-color) .ral-code,
.ral-color-preview:not(.has-color) .color-name {
    color: #a0aec0;
}

.quantity-section {
    margin-bottom: 25px;
}

.quantity-label {
    display: block;
    margin-bottom: 10px;
    color: #2d3748;
    font-weight: 600;
}

.quantity-controls {
    display: flex;
    align-items: center;
    gap: 10px;
}

.quantity-btn {
    width: 45px;
    height: 45px;
    border: 2px solid #e2e8f0;
    background: white;
    border-radius: 12px;
    font-size: 20px;
    cursor: pointer;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    justify-content: center;
}

.quantity-btn:hover {
    border-color: #667eea;
    background: #667eea;
    color: white;
}

.quantity-input {
    flex: 1;
    width: 80px;
    height: 45px;
    border: 2px solid #e2e8f0;
    border-radius: 12px;
    text-align: center;
    font-size: 18px;
    font-weight: 600;
}

.quantity-input:focus {
    outline: none;
    border-color: #667eea;
}

.action-buttons {
    display: flex;
    gap: 15px;
    align-items: center;
    margin-bottom: 25px;
}

.add-to-cart-btn {
    flex: 1;
    background: var(--secondary-gradient);
    color: white;
    border: none;
    padding: 20px 30px;
    border-radius: 15px;
    font-size: 18px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s ease;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 12px;
}

.add-to-cart-btn:hover {
    transform: translateY(-3px);
    box-shadow: 0 12px 25px rgba(102, 126, 234, 0.4);
}

.product-features {
    display: flex;
    flex-direction: column;
    gap: 15px;
    padding: 25px;
    background: #f8fafc;
    border-radius: 15px;
    border: 2px solid #e2e8f0;
}

.feature-item {
    display: flex;
    align-items: center;
    gap: 15px;
}

.feature-icon {
    font-size: 20px;
    width: 24px;
}

.feature-text {
    color: #4a5568;
    font-size: 15px;
    font-weight: 500;
}

.product-description {
    border-top: 2px solid #e2e8f0;
    padding-top: 40px;
    height: auto;
}

.description-title {
    color: #2d3748;
    font-size: 28px;
    margin-bottom: 25px;
    font-weight: 700;
}

.description-content {
    color: #4a5568;
    line-height: 1.7;
    font-size: 16px;
}

.tech-specs {
    margin: 30px 0;
    padding: 25px;
    background: #f8fafc;
    border-radius: 15px;
    border-left: 4px solid #667eea;
}

.tech-specs h4 {
    color: #2d3748;
    font-size: 20px;
    margin-bottom: 15px;
    font-weight: 600;
}

.specs-list {
    color: #4a5568;
    line-height: 1.8;
    padding-left: 20px;
}

.specs-list li {
    margin-bottom: 8px;
    position: relative;
}

.specs-list li::before {
    content: '‚úì';
    color: #48bb78;
    font-weight: bold;
    position: absolute;
    left: -20px;
}

.application-areas {
    margin-top: 30px;
}

.application-areas h4 {
    color: #2d3748;
    font-size: 20px;
    margin-bottom: 20px;
    font-weight: 600;
}

.areas-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 15px;
}

.area-item {
    background: white;
    padding: 15px;
    border-radius: 10px;
    border: 2px solid #e2e8f0;
    text-align: center;
    font-weight: 500;
    color: #4a5568;
    transition: all 0.3s ease;
}

.area-item:hover {
    border-color: #667eea;
    transform: translateY(-2px);
    box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
}

/* –ê–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤ */
@media (max-width: 1024px) {
    .product-content {
        gap: 30px;
    }
}

@media (max-width: 768px) {
    .product-container {
        padding: 10px;
    }

    .product-card {
        padding: 20px;
        border-radius: 16px;
    }

    .product-content {
        grid-template-columns: 1fr;
        gap: 30px;
    }

    .product-title {
        font-size: 28px;
    }

    .current-price {
        font-size: 32px;
    }

    .action-buttons {
        flex-direction: column;
    }

    .areas-grid {
        grid-template-columns: 1fr 1fr;
    }

    .header-top {
        flex-direction: column;
        align-items: flex-start;
    }

    .back-btn {
        align-self: flex-start;
    }

    .ral-color-preview {
        height: 70px;
        margin-top: -10px;
        padding-top: 18px;
    }
    
    .text-overlay {
        padding: 10px 16px;
    }
    
    .ral-code {
        font-size: 16px;
    }
    
    .color-name {
        font-size: 13px;
        max-width: 150px;
    }
    
    .select-options {
        position: fixed;
        top: 50%;
        left: 20px;
        right: 20px;
        transform: translateY(-50%);
        max-height: 70vh;
        z-index: 1001;
    }
    
    .options-list {
        max-height: 50vh;
    }
}

@media (max-width: 480px) {
    .areas-grid {
        grid-template-columns: 1fr;
    }

    .back-btn {
        width: 100%;
        justify-content: center;
    }

    .ral-color-preview {
        height: 60px;
        margin-top: -8px;
        padding-top: 15px;
    }
    
    .text-overlay {
        padding: 8px 12px;
    }
    
    .ral-code {
        font-size: 15px;
    }
    
    .color-name {
        font-size: 12px;
        max-width: 120px;
    }
    
    .option-item {
        padding: 10px 15px;
    }
    
    .search-input {
        padding: 10px 40px 10px 12px;
        font-size: 13px;
    }
    
    .select-header {
        padding: 12px 15px;
        min-height: 50px;
    }
    
    .select-placeholder {
        font-size: 14px;
    }
}

/* –û–≤–µ—Ä–ª–µ–π –¥–ª—è –º–æ–±–∏–ª—å–Ω–æ–≥–æ –≤—ã–ø–∞–¥–∞—é—â–µ–≥–æ —Å–ø–∏—Å–∫–∞ */
.select-overlay {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0, 0, 0, 0.5);
    z-index: 1000;
    display: none;
}

.select-overlay.show {
    display: block;
    animation: fadeIn 0.3s ease;
}

@keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
}

/* –ê–Ω–∏–º–∞—Ü–∏–∏ */
@keyframes fadeIn {
    from {
        opacity: 0;
        transform: translateY(30px);
    }
    to {
        opacity: 1;
        transform: translateY(0);
    }
}

.product-card {
    animation: fadeIn 0.8s ease-out;
}

.ral-selection {
    animation: fadeIn 0.6s ease-out 0.2s both;
}

.back-btn {
    animation: fadeIn 0.6s ease-out 0.2s both;
}

.ral-color-preview {
    animation: fadeIn 0.6s ease-out 0.3s both;
}
</style>

<script>
document.addEventListener('DOMContentLoaded', function() {
    // –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º
    const minusBtn = document.querySelector('.minus-btn');
    const plusBtn = document.querySelector('.plus-btn');
    const quantityInput = document.querySelector('.quantity-input');

    minusBtn.addEventListener('click', function() {
        let value = parseInt(quantityInput.value);
        if (value > 1) {
            quantityInput.value = value - 1;
        }
    });

    plusBtn.addEventListener('click', function() {
        let value = parseInt(quantityInput.value);
        quantityInput.value = value + 1;
    });

    // –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –≤–≤–æ–¥–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –≤—Ä—É—á–Ω—É—é
    quantityInput.addEventListener('change', function() {
        let value = parseInt(this.value);
        if (value < 1) this.value = 1;
    });

    // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –¥–ª—è –∫–Ω–æ–ø–∫–∏ "–ù–∞–∑–∞–¥"
    const backBtn = document.querySelector('.back-btn');
    backBtn.addEventListener('click', function(e) {
        if (window.history.length <= 1) {
            e.preventDefault();
            window.location.href = "{{ url_for('buyer.catalog') }}";
        }
    });

    // –ö–∞—Å—Ç–æ–º–Ω—ã–π —Å–µ–ª–µ–∫—Ç –¥–ª—è RAL —Ü–≤–µ—Ç–æ–≤
    const selectHeader = document.getElementById('selectHeader');
    const selectOptions = document.getElementById('selectOptions');
    const optionsList = document.getElementById('optionsList');
    const ralSearch = document.getElementById('ralSearch');
    const ralColorPreview = document.getElementById('ralColorPreview');
    const selectedRalInput = document.getElementById('selectedRal');
    const ralCode = ralColorPreview.querySelector('.ral-code');
    const colorName = ralColorPreview.querySelector('.color-name');
    
    let ralColors = [];
    let isMobile = window.innerWidth <= 768;

    // –°–æ–∑–¥–∞–µ–º –æ–≤–µ—Ä–ª–µ–π –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤
    const overlay = document.createElement('div');
    overlay.className = 'select-overlay';
    document.body.appendChild(overlay);

    // –ó–∞–≥—Ä—É–∑–∫–∞ RAL —Ü–≤–µ—Ç–æ–≤
    fetch('../../static/json/RAL.json')
        .then(response => {
            if (!response.ok) throw new Error('Network response was not ok');
            return response.json();
        })
        .then(data => {
            ralColors = data.RAL.sort((a, b) => parseInt(a.RAL) - parseInt(b.RAL));
            renderOptions(ralColors);
        })
        .catch(error => {
            console.error('Error loading RAL colors:', error);
            optionsList.innerHTML = '<div class="no-results">–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ü–≤–µ—Ç–æ–≤</div>';
        });

    // –†–µ–Ω–¥–µ—Ä –æ–ø—Ü–∏–π
    function renderOptions(colors) {
        optionsList.innerHTML = '';
        
        if (colors.length === 0) {
            optionsList.innerHTML = '<div class="no-results">–¶–≤–µ—Ç–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</div>';
            return;
        }
        
        colors.forEach(color => {
            const option = document.createElement('div');
            option.className = 'option-item';
            option.innerHTML = `
                <div class="option-color" style="background-color: ${color.HTML}"></div>
                <div class="option-info">
                    <div class="option-ral">RAL ${color.RAL}</div>
                    <div class="option-name">${color.name}</div>
                </div>
            `;
            
            option.addEventListener('click', () => selectColor(color));
            optionsList.appendChild(option);
        });
    }

    // –í—ã–±–æ—Ä —Ü–≤–µ—Ç–∞
    function selectColor(color) {
        // –û–±–Ω–æ–≤–ª—è–µ–º –∑–∞–≥–æ–ª–æ–≤–æ–∫ —Å–µ–ª–µ–∫—Ç–∞
        selectHeader.querySelector('.select-placeholder').textContent = `RAL ${color.RAL} - ${color.name}`;
        
        // –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–µ–¥–ø—Ä–æ—Å–º–æ—Ç—Ä - —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º CSS –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –¥–ª—è —Ü–≤–µ—Ç–∞
        ralColorPreview.style.setProperty('--selected-color', color.HTML);
        ralCode.textContent = `RAL ${color.RAL}`;
        colorName.textContent = color.name;
        ralColorPreview.classList.add('has-color');
        
        // –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤—ã–±—Ä–∞–Ω–Ω—ã–π RAL
        selectedRalInput.value = color.RAL;
        
        // –ó–∞–∫—Ä—ã–≤–∞–µ–º –≤—ã–ø–∞–¥–∞—é—â–∏–π —Å–ø–∏—Å–æ–∫
        closeSelect();
        
        // –ü–æ–º–µ—á–∞–µ–º –≤—ã–±—Ä–∞–Ω–Ω—É—é –æ–ø—Ü–∏—é
        document.querySelectorAll('.option-item').forEach(item => {
            item.classList.remove('selected');
        });
        event.target.closest('.option-item').classList.add('selected');
    }

    // –û—Ç–∫—Ä—ã—Ç–∏–µ/–∑–∞–∫—Ä—ã—Ç–∏–µ —Å–µ–ª–µ–∫—Ç–∞
    function toggleSelect() {
        const isActive = selectOptions.classList.contains('show');
        
        if (isActive) {
            closeSelect();
        } else {
            openSelect();
        }
    }

    function openSelect() {
        selectHeader.classList.add('active');
        selectOptions.classList.add('show');
        
        if (isMobile) {
            overlay.classList.add('show');
            document.body.style.overflow = 'hidden';
        }
    }

    function closeSelect() {
        selectHeader.classList.remove('active');
        selectOptions.classList.remove('show');
        overlay.classList.remove('show');
        document.body.style.overflow = '';
        ralSearch.value = '';
        renderOptions(ralColors);
    }

    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π
    selectHeader.addEventListener('click', toggleSelect);
    
    overlay.addEventListener('click', closeSelect);
    
    // –ü–æ–∏—Å–∫ –ø–æ —Ü–≤–µ—Ç–∞–º
    ralSearch.addEventListener('input', function() {
        const searchTerm = this.value.toLowerCase();
        const filteredColors = ralColors.filter(color => 
            color.RAL.toLowerCase().includes(searchTerm) ||
            color.name.toLowerCase().includes(searchTerm)
        );
        renderOptions(filteredColors);
    });

    // –ó–∞–∫—Ä—ã—Ç–∏–µ –ø–æ –∫–ª–∏–∫—É –≤–Ω–µ —ç–ª–µ–º–µ–Ω—Ç–∞
    document.addEventListener('click', function(event) {
        if (!event.target.closest('.custom-select') && !event.target.closest('.select-overlay')) {
            closeSelect();
        }
    });

    // –û–±—Ä–∞–±–æ—Ç–∫–∞ Escape
    document.addEventListener('keydown', function(event) {
        if (event.key === 'Escape') {
            closeSelect();
        }
    });

    // –ê–¥–∞–ø—Ç–∞—Ü–∏—è –∫ –∏–∑–º–µ–Ω–µ–Ω–∏—é —Ä–∞–∑–º–µ—Ä–∞ –æ–∫–Ω–∞
    window.addEventListener('resize', function() {
        isMobile = window.innerWidth <= 768;
    });
});

</script>
{% endblock %}